cat >Caddyfile<<EOF
:${CADDY_PORT:-80} {
  proxy / ${CADDY_UI_URL:-${CADDY_UI_SCHEME:-http}://${CADDY_UI:-ui}} {
    header_upstream Host ${CADDY_UI_HOST:-{host}}
    header_upstream X-Real-IP {remote}
    header_upstream X-Forwarded-For {remote}
    header_upstream X-Forwarded-Proto {scheme}
  }
  proxy /api ${CADDY_API_URL:-${CADDY_API_SCHEME:-http}://${CADDY_API:-api}} {
    without /api
    header_upstream Host ${CADDY_API_HOST:-{host}}
    header_upstream X-Real-IP {remote}
    header_upstream X-Forwarded-For {remote}
    header_upstream X-Forwarded-Proto {scheme}
  }
}
EOF
